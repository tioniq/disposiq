var l=(s,o,e)=>new Promise((t,n)=>{var b=d=>{try{w(e.next(d))}catch(C){n(C)}},H=d=>{try{w(e.throw(d))}catch(C){n(C)}},w=d=>d.done?t(d.value):Promise.resolve(d.value).then(b,H);w((e=e.apply(s,o)).next())});"dispose"in Symbol||(Symbol.dispose=Symbol("Symbol.dispose"));"asyncDispose"in Symbol||(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));var i=class{[Symbol.dispose](){this.dispose()}},a=class extends i{[Symbol.asyncDispose](){return this.dispose()}};var u=class extends i{constructor(o){super(),this._controller=o}get disposed(){return this._controller.signal.aborted}get signal(){return this._controller.signal}dispose(){this._controller.abort()}};var f=Object.freeze(()=>{}),y=Object.freeze(()=>Promise.resolve());var r=class extends i{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:f}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._action())}},m=class extends a{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:y}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){this._disposed||(this._disposed=!0,yield this._action())})}};var g=class{constructor(o){this.value=o,this.next=null}},h=class{constructor(){this.head=null,this.tail=null,this.length=0}enqueue(o){let e=new g(o);this.head?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),this.length++}dequeue(){let o=this.head;return o===null?null:(this.head=o.next,this.length--,o.value)}isEmpty(){return this.length===0}getHead(){var o,e;return(e=(o=this.head)==null?void 0:o.value)!=null?e:null}getLength(){return this.length}forEach(o){let e=this.head;for(;e!==null;)o(e.value),e=e.next}toArray(){let o=[],e=this.head;for(;e!==null;)o.push(e.value),e=e.next;return o}clear(){this.head=null,this.tail=null,this.length=0}};var D=class{constructor(o){this._scrap=new h,this._size=o}get size(){return this._size}set size(o){this._size=o}get all(){return this._scrap.toArray()}get full(){return this._scrap.length===this._size}lift(){return this._scrap.length>0?this._scrap.dequeue():null}throw(o){if(this._scrap.length<this._size)return this._scrap.enqueue(o),null;if(this._size===0)return o;let e=this._scrap.dequeue();return this._scrap.enqueue(o),e}clear(){this._scrap.clear()}};var _=new D(10);function S(s){let o=s.length;if(o===0)return;let e=_.lift();e===null?e=new Array(o):e.length<o&&(e.length=o);for(let t=0;t<o;t++)e[t]=s[t];s.length=0;for(let t=0;t<o;++t){let n=e[t];n&&(typeof n=="function"?n():n.dispose())}e.fill(void 0,0,o),_.full&&(_.size*=2),_.throw(e)}function R(s){for(let o=0;o<s.length;++o){let e=s[o];e&&(typeof e=="function"?e():e.dispose())}s.length=0}var v=class extends Error{constructor(o){super(o||"Object disposed")}};var c=class s extends i{constructor(){super();this._disposed=!1;this._disposables=new Array}get disposed(){return this._disposed}add(...e){this.addAll(e)}addAll(e){if(!(!e||e.length===0)){if(this._disposed){for(let t of e)t&&(typeof t=="function"?t():t.dispose());return}for(let t=0;t<e.length;t++){let n=e[t];n&&this._disposables.push(typeof n=="function"?new r(n):n)}}}addOne(e){if(e){if(this._disposed){typeof e=="function"?e():e.dispose();return}typeof e=="function"&&(e=new r(e)),this._disposables.push(e)}}remove(e){let t=this._disposables.indexOf(e);return t===-1?!1:(this._disposables.splice(t,1),!0)}addTimeout(e,t){if(typeof e=="function"){let n=setTimeout(e,t);this.add(()=>clearTimeout(n));return}this.add(()=>clearTimeout(e))}addInterval(e,t){if(typeof e=="function"){let n=setInterval(e,t);this.add(()=>clearInterval(n));return}this.add(()=>clearInterval(e))}throwIfDisposed(e){if(this._disposed)throw new v(e)}dispose(){this._disposed||(this._disposed=!0,R(this._disposables))}disposeCurrent(){S(this._disposables)}static from(e,t){if(typeof t=="function"){let b=new s;return b.addAll(e.map(t)),b}let n=new s;return n.addAll(e),n}};var T=class extends i{constructor(e=void 0){super();this._disposed=!1;this._disposable=e}get disposed(){return this._disposed}get disposable(){return this._disposable}set(e){if(this._disposed){e.dispose();return}let t=this._disposable;this._disposable=e,t!=null&&t.dispose()}replace(e){if(this._disposed){e.dispose();return}this._disposable=e}disposeCurrent(){let e=this._disposable;e!=null&&(this._disposable=void 0,e.dispose())}dispose(){this._disposed||(this._disposed=!0,this._disposable!=null&&(this._disposable.dispose(),this._disposable=void 0))}};var I=class extends i{constructor(e=!1){super();this._disposed=!1;this._disposed=e}get disposed(){return this._disposed}dispose(){this._disposed=!0}};function F(s,o,e){return s.on(o,e),new r(()=>{s.off(o,e)})}function W(s,o,e){return s.once(o,e),new r(()=>{s.off(o,e)})}var P=Promise.resolve(),q=class extends a{dispose(){return P}[Symbol.dispose](){}[Symbol.asyncDispose](){return P}},O=new q,p=Object.freeze(O);function B(s){return s?typeof s=="function"?new r(s):typeof s!="object"?p:"dispose"in s?s:Symbol.dispose in s?new r(()=>{s[Symbol.dispose]()}):Symbol.asyncDispose in s?new m(()=>l(this,null,function*(){yield s[Symbol.asyncDispose]()})):"unref"in s?new r(()=>s.unref()):s instanceof AbortController?new u(s):p:p}function N(s){if(!s)return p;if(typeof s=="function")return new r(s);if(typeof s!="object")return p;let o="dispose"in s,e=Symbol.dispose in s;return o&&e?s:o?new r(()=>s.dispose()):e?new r(()=>s[Symbol.dispose]()):Symbol.asyncDispose in s?new r(()=>l(this,null,function*(){s[Symbol.asyncDispose]()})):"unref"in s?new r(()=>s.unref()):s instanceof AbortController?new u(s):p}function U(s){if(!s)return p;if(s instanceof i)return s;if(typeof s=="function")return new r(s);if(typeof s!="object")return p;let o="dispose"in s&&typeof s.dispose=="function",e=Symbol.dispose in s;return o&&e?new class extends i{dispose(){s.dispose()}[Symbol.dispose](){s[Symbol.dispose]()}}:o?new r(()=>s.dispose()):e?new r(()=>s[Symbol.dispose]()):Symbol.asyncDispose in s?new m(()=>l(this,null,function*(){yield s[Symbol.asyncDispose]()})):"unref"in s?new r(()=>s.unref()):s instanceof AbortController?new u(s):p}var E=class extends i{constructor(){super(...arguments);this._store=new c}get disposed(){return this._store.disposed}register(e){return this._store.addOne(e),e}throwIfDisposed(e){this._store.throwIfDisposed(e)}addDisposable(e){this._store.addOne(e)}addDisposables(...e){this._store.addAll(e)}dispose(){this._store.dispose()}};i.prototype.disposeWith=function(s){return s.add(this)};function Fe(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"}function We(s){return typeof s=="function"||typeof s=="object"&&s!==null&&typeof s.dispose=="function"}function Oe(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&typeof s[Symbol.dispose]=="function"}function Be(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&typeof s[Symbol.asyncDispose]=="function"}function Ne(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.dispose]=="function"}function Ue(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.asyncDispose]=="function"}var x=class{constructor(o){this._handler=this._defaultHandler=typeof o=="function"?o:f}get handler(){return this._handler}set handler(o){this._handler=typeof o=="function"?o:this._defaultHandler}reset(){this._handler=this._defaultHandler}handle(o){this._handler(o)}handleSafe(o){try{this.handle(o)}catch(e){}}};var K=new x,z=class extends i{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:f}get disposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;try{this._action()}catch(e){K.handle(e)}}}},j=class extends a{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:y}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){if(!this._disposed){this._disposed=!0;try{yield this._action()}catch(e){K.handle(e)}}})}};function $e(s,o){let e;try{e=o(s)}catch(t){return A(s,()=>{throw t})}return e instanceof Promise?e.then(t=>A(s,()=>t)).catch(t=>A(s,()=>{throw t})):A(s,()=>e)}function A(s,o){let e=s.dispose();return e instanceof Promise?e.then(o):o()}export{u as AbortDisposable,m as AsyncDisposableAction,a as AsyncDisposiq,a as BaseAsyncDisposable,i as BaseDisposable,I as BoolDisposable,I as BooleanDisposable,c as CompositeDisposable,E as Disposable,r as DisposableAction,T as DisposableContainer,c as DisposableStore,i as Disposiq,v as ObjectDisposedException,z as SafeActionDisposable,j as SafeAsyncActionDisposable,T as SerialDisposable,B as createDisposable,N as createDisposableCompat,U as createDisposiq,F as disposableFromEvent,W as disposableFromEventOnce,S as disposeAll,S as disposeAllSafe,R as disposeAllUnsafe,p as emptyDisposable,Be as isAsyncDisposableCompat,Fe as isDisposable,Oe as isDisposableCompat,We as isDisposableLike,Ue as isSystemAsyncDisposable,Ne as isSystemDisposable,F as on,W as once,K as safeDisposableExceptionHandlerManager,B as toDisposable,N as toDisposableCompat,U as toDisposiq,$e as using};
//# sourceMappingURL=index.js.map