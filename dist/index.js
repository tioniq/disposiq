var l=(s,o,e)=>new Promise((t,n)=>{var O=a=>{try{A(e.next(a))}catch(C){n(C)}},B=a=>{try{A(e.throw(a))}catch(C){n(C)}},A=a=>a.done?t(a.value):Promise.resolve(a.value).then(O,B);A((e=e.apply(s,o)).next())});"dispose"in Symbol||(Symbol.dispose=Symbol("Symbol.dispose"));"asyncDispose"in Symbol||(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));var i=class{[Symbol.dispose](){this.dispose()}},p=class extends i{[Symbol.asyncDispose](){return this.dispose()}};var u=class extends i{constructor(o){super(),this._controller=o}get disposed(){return this._controller.signal.aborted}get signal(){return this._controller.signal}dispose(){this._controller.abort()}};var d=Object.freeze(()=>{}),f=Object.freeze(()=>Promise.resolve());var r=class extends i{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:d}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._action())}},b=class extends p{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:f}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){this._disposed||(this._disposed=!0,yield this._action())})}};var g=class{constructor(o){this.value=o,this.next=null}},h=class{constructor(){this.head=null,this.tail=null,this.length=0}enqueue(o){let e=new g(o);this.head?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),this.length++}dequeue(){let o=this.head;return o===null?null:(this.head=o.next,this.length--,o.value)}isEmpty(){return this.length===0}getHead(){var o,e;return(e=(o=this.head)==null?void 0:o.value)!=null?e:null}getLength(){return this.length}forEach(o){let e=this.head;for(;e!==null;)o(e.value),e=e.next}toArray(){let o=[],e=this.head;for(;e!==null;)o.push(e.value),e=e.next;return o}clear(){this.head=null,this.tail=null,this.length=0}};var y=class{constructor(o){this._scrap=new h,this._size=o}get size(){return this._size}set size(o){this._size=o}get all(){return this._scrap.toArray()}get full(){return this._scrap.length===this._size}lift(){return this._scrap.length>0?this._scrap.dequeue():null}throw(o){if(this._scrap.length<this._size)return this._scrap.enqueue(o),null;if(this._size===0)return o;let e=this._scrap.dequeue();return this._scrap.enqueue(o),e}clear(){this._scrap.clear()}};var D=new y(10);function _(s){let o=s.length;if(o===0)return;let e=D.lift();e===null?e=new Array(o):e.length<o&&(e.length=o);for(let t=0;t<o;t++)e[t]=s[t];s.length=0;for(let t=0;t<o;++t){let n=e[t];n&&(typeof n=="function"?n():n.dispose())}e.fill(void 0,0,o),D.full&&(D.size*=2),D.throw(e)}function I(s){for(let o=0;o<s.length;++o){let e=s[o];e&&(typeof e=="function"?e():e.dispose())}s.length=0}var m=class extends i{constructor(){super();this._disposed=!1;this._disposables=new Array}get disposed(){return this._disposed}add(...e){this.addAll(e)}addAll(e){if(!(!e||e.length===0)){if(this._disposed){for(let t of e)t&&(typeof t=="function"?t():t.dispose());return}for(let t=0;t<e.length;t++){let n=e[t];n&&this._disposables.push(typeof n=="function"?new r(n):n)}}}addOne(e){if(e){if(this._disposed){typeof e=="function"?e():e.dispose();return}typeof e=="function"&&(e=new r(e)),this._disposables.push(e)}}remove(e){let t=this._disposables.indexOf(e);return t===-1?!1:(this._disposables.splice(t,1),!0)}addTimeout(e,t){if(typeof e=="function"){let n=setTimeout(e,t);this.add(()=>clearTimeout(n));return}this.add(()=>clearTimeout(e))}addInterval(e,t){if(typeof e=="function"){let n=setInterval(e,t);this.add(()=>clearInterval(n));return}this.add(()=>clearInterval(e))}dispose(){this._disposed||(this._disposed=!0,I(this._disposables))}disposeCurrent(){_(this._disposables)}};var w=class extends i{constructor(e=void 0){super();this._disposed=!1;this._disposable=e}get disposed(){return this._disposed}get disposable(){return this._disposable}set(e){if(this._disposed){e.dispose();return}let t=this._disposable;this._disposable=e,t!=null&&t.dispose()}replace(e){if(this._disposed){e.dispose();return}this._disposable=e}disposeCurrent(){let e=this._disposable;e!=null&&(this._disposable=void 0,e.dispose())}dispose(){this._disposed||(this._disposed=!0,this._disposable!=null&&(this._disposable.dispose(),this._disposable=void 0))}};var T=class extends i{constructor(e=!1){super();this._disposed=!1;this._disposed=e}get disposed(){return this._disposed}dispose(){this._disposed=!0}};function R(s,o,e){return s.on(o,e),new r(()=>{s.off(o,e)})}function q(s,o,e){return s.once(o,e),new r(()=>{s.off(o,e)})}var P=Promise.resolve(),S=class extends p{dispose(){return P}[Symbol.dispose](){}[Symbol.asyncDispose](){return P}},N=new S,c=Object.freeze(N);function E(s){if(!s)return c;if(typeof s=="function")return new r(s);if(typeof s=="object"){if("dispose"in s)return s;if(Symbol.dispose in s)return new r(()=>{let o=s[Symbol.dispose];o()});if(Symbol.asyncDispose in s)return new b(()=>l(this,null,function*(){let o=s[Symbol.asyncDispose];yield o()}));if("unref"in s)return new r(()=>s.unref());if(s instanceof AbortController)return new u(s)}return c}function z(s){if(!s)return c;if(typeof s=="function")return new r(s);if(typeof s=="object"){let o="dispose"in s,e=Symbol.dispose in s;if(o&&e)return s;if(o)return new r(()=>s.dispose());if(e)return new r(()=>s[Symbol.dispose]());if(Symbol.asyncDispose in s)return new r(()=>l(this,null,function*(){s[Symbol.asyncDispose]()}));if("unref"in s)return new r(()=>s.unref());if(s instanceof AbortController)return new u(s)}return c}var Se=_,Ie=R,Re=q,qe=E,Pe=z;var K=class extends i{constructor(){super(...arguments);this._store=new m}get disposed(){return this._store.disposed}register(e){return this._store.addOne(e),e}addDisposable(e){this._store.addOne(e)}addDisposables(...e){this._store.addAll(e)}dispose(){this._store.dispose()}};var j=class extends Error{constructor(o){super(o||"Object disposed")}};i.prototype.disposeWith=function(s){return s.add(this)};function We(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"}function Oe(s){return typeof s=="function"||typeof s=="object"&&s!==null&&typeof s.dispose=="function"}function Be(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&typeof s[Symbol.dispose]=="function"}function Ne(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&typeof s[Symbol.asyncDispose]=="function"}function Ue(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.dispose]=="function"}function Me(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.asyncDispose]=="function"}var x=class{constructor(o){this._handler=this._defaultHandler=typeof o=="function"?o:d}get handler(){return this._handler}set handler(o){this._handler=typeof o=="function"?o:this._defaultHandler}reset(){this._handler=this._defaultHandler}handle(o){this._handler(o)}handleSafe(o){try{this.handle(o)}catch(e){}}};var W=new x,H=class extends i{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:d}get disposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;try{this._action()}catch(e){W.handle(e)}}}},F=class extends p{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:f}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){if(!this._disposed){this._disposed=!0;try{yield this._action()}catch(e){W.handle(e)}}})}};function Le(s,o){let e;try{e=o(s)}catch(t){return v(s,()=>{throw t})}return e instanceof Promise?e.then(t=>v(s,()=>t)).catch(t=>v(s,()=>{throw t})):v(s,()=>e)}function v(s,o){let e=s.dispose();return e instanceof Promise?e.then(o):o()}export{u as AbortDisposable,b as AsyncDisposableAction,p as AsyncDisposiq,i as BaseDisposable,T as BoolDisposable,T as BooleanDisposable,m as CompositeDisposable,K as Disposable,r as DisposableAction,w as DisposableContainer,m as DisposableStore,i as Disposiq,j as ObjectDisposedException,H as SafeActionDisposable,F as SafeAsyncActionDisposable,w as SerialDisposable,E as createDisposable,z as createDisposableCompat,R as disposableFromEvent,q as disposableFromEventOnce,_ as disposeAll,Se as disposeAllSafe,I as disposeAllUnsafe,c as emptyDisposable,Ne as isAsyncDisposableCompat,We as isDisposable,Be as isDisposableCompat,Oe as isDisposableLike,Me as isSystemAsyncDisposable,Ue as isSystemDisposable,Ie as on,Re as once,W as safeDisposableExceptionHandlerManager,qe as toDisposable,Pe as toDisposableCompat,Le as using};
//# sourceMappingURL=index.js.map