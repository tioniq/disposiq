var l=(e,o,s)=>new Promise((t,n)=>{var K=d=>{try{v(s.next(d))}catch(A){n(A)}},H=d=>{try{v(s.throw(d))}catch(A){n(A)}},v=d=>d.done?t(d.value):Promise.resolve(d.value).then(K,H);v((s=s.apply(e,o)).next())});"dispose"in Symbol||(Symbol.dispose=Symbol("Symbol.dispose"));"asyncDispose"in Symbol||(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));var i=class{[Symbol.dispose](){this.dispose()}},a=class extends i{[Symbol.asyncDispose](){return this.dispose()}};var u=class extends i{constructor(o){super(),this._controller=o}get disposed(){return this._controller.signal.aborted}get signal(){return this._controller.signal}dispose(){this._controller.abort()}};var f=Object.freeze(()=>{}),b=Object.freeze(()=>Promise.resolve());var r=class extends i{constructor(s){super();this._disposed=!1;this._action=typeof s=="function"?s:f}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._action())}},m=class extends a{constructor(s){super();this._disposed=!1;this._action=typeof s=="function"?s:b}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){this._disposed||(this._disposed=!0,yield this._action())})}};var C=class{constructor(o){this.value=o,this.next=null}},y=class{constructor(){this.head=null,this.tail=null,this.length=0}enqueue(o){let s=new C(o);this.head?(this.tail.next=s,this.tail=s):(this.head=s,this.tail=s),this.length++}dequeue(){let o=this.head;return o===null?null:(this.head=o.next,this.length--,o.value)}isEmpty(){return this.length===0}getHead(){var o,s;return(s=(o=this.head)==null?void 0:o.value)!=null?s:null}getLength(){return this.length}forEach(o){let s=this.head;for(;s!==null;)o(s.value),s=s.next}toArray(){let o=[],s=this.head;for(;s!==null;)o.push(s.value),s=s.next;return o}clear(){this.head=null,this.tail=null,this.length=0}};var h=class{constructor(o){this._scrap=new y,this._size=o}get size(){return this._size}set size(o){this._size=o}get all(){return this._scrap.toArray()}get full(){return this._scrap.length===this._size}lift(){return this._scrap.length>0?this._scrap.dequeue():null}throw(o){if(this._scrap.length<this._size)return this._scrap.enqueue(o),null;if(this._size===0)return o;let s=this._scrap.dequeue();return this._scrap.enqueue(o),s}clear(){this._scrap.clear()}};var D=new h(10);function w(e){let o=e.length;if(o===0)return;let s=D.lift();s===null?s=new Array(o):s.length<o&&(s.length=o);for(let t=0;t<o;t++)s[t]=e[t];e.length=0;for(let t=0;t<o;++t){let n=s[t];n&&(typeof n=="function"?n():n.dispose())}s.fill(void 0,0,o),D.full&&(D.size*=2),D.throw(s)}function I(e){for(let o=0;o<e.length;++o){let s=e[o];s&&(typeof s=="function"?s():s.dispose())}e.length=0}var c=class extends i{constructor(){super();this._disposed=!1;this._disposables=new Array}get disposed(){return this._disposed}add(...s){this.addAll(s)}addAll(s){if(!(!s||s.length===0)){if(this._disposed){for(let t of s)t&&(typeof t=="function"?t():t.dispose());return}for(let t=0;t<s.length;t++){let n=s[t];n&&this._disposables.push(typeof n=="function"?new r(n):n)}}}addOne(s){if(s){if(this._disposed){typeof s=="function"?s():s.dispose();return}typeof s=="function"&&(s=new r(s)),this._disposables.push(s)}}remove(s){let t=this._disposables.indexOf(s);return t===-1?!1:(this._disposables.splice(t,1),!0)}addTimeout(s,t){if(typeof s=="function"){let n=setTimeout(s,t);this.add(()=>clearTimeout(n));return}this.add(()=>clearTimeout(s))}addInterval(s,t){if(typeof s=="function"){let n=setInterval(s,t);this.add(()=>clearInterval(n));return}this.add(()=>clearInterval(s))}dispose(){this._disposed||(this._disposed=!0,I(this._disposables))}disposeCurrent(){w(this._disposables)}};var g=class extends i{constructor(s=void 0){super();this._disposed=!1;this._disposable=s}get disposed(){return this._disposed}get disposable(){return this._disposable}set(s){if(this._disposed){s.dispose();return}let t=this._disposable;this._disposable=s,t!=null&&t.dispose()}replace(s){if(this._disposed){s.dispose();return}this._disposable=s}disposeCurrent(){let s=this._disposable;s!=null&&(this._disposable=void 0,s.dispose())}dispose(){this._disposed||(this._disposed=!0,this._disposable!=null&&(this._disposable.dispose(),this._disposable=void 0))}};var S=class extends i{constructor(s=!1){super();this._disposed=!1;this._disposed=s}get disposed(){return this._disposed}dispose(){this._disposed=!0}};function F(e,o,s){return e.on(o,s),new r(()=>{e.off(o,s)})}function W(e,o,s){return e.once(o,s),new r(()=>{e.off(o,s)})}var q=Promise.resolve(),T=class extends a{dispose(){return q}[Symbol.dispose](){}[Symbol.asyncDispose](){return q}},O=new T,p=Object.freeze(O);function B(e){return e?typeof e=="function"?new r(e):typeof e!="object"?p:"dispose"in e?e:Symbol.dispose in e?new r(()=>{e[Symbol.dispose]()}):Symbol.asyncDispose in e?new m(()=>l(this,null,function*(){yield e[Symbol.asyncDispose]()})):"unref"in e?new r(()=>e.unref()):e instanceof AbortController?new u(e):p:p}function N(e){if(!e)return p;if(typeof e=="function")return new r(e);if(typeof e!="object")return p;let o="dispose"in e,s=Symbol.dispose in e;return o&&s?e:o?new r(()=>e.dispose()):s?new r(()=>e[Symbol.dispose]()):Symbol.asyncDispose in e?new r(()=>l(this,null,function*(){e[Symbol.asyncDispose]()})):"unref"in e?new r(()=>e.unref()):e instanceof AbortController?new u(e):p}function U(e){if(!e)return p;if(e instanceof i)return e;if(typeof e=="function")return new r(e);if(typeof e!="object")return p;let o="dispose"in e&&typeof e.dispose=="function",s=Symbol.dispose in e;return o&&s?new class extends i{dispose(){e.dispose()}[Symbol.dispose](){e[Symbol.dispose]()}}:o?new r(()=>e.dispose()):s?new r(()=>e[Symbol.dispose]()):Symbol.asyncDispose in e?new m(()=>l(this,null,function*(){yield e[Symbol.asyncDispose]()})):"unref"in e?new r(()=>e.unref()):e instanceof AbortController?new u(e):p}var R=class extends i{constructor(){super(...arguments);this._store=new c}get disposed(){return this._store.disposed}register(s){return this._store.addOne(s),s}addDisposable(s){this._store.addOne(s)}addDisposables(...s){this._store.addAll(s)}dispose(){this._store.dispose()}};var P=class extends Error{constructor(o){super(o||"Object disposed")}};i.prototype.disposeWith=function(e){return e.add(this)};function He(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"}function Fe(e){return typeof e=="function"||typeof e=="object"&&e!==null&&typeof e.dispose=="function"}function We(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"&&typeof e[Symbol.dispose]=="function"}function Oe(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"&&typeof e[Symbol.asyncDispose]=="function"}function Be(e){return typeof e=="object"&&e!==null&&typeof e[Symbol.dispose]=="function"}function Ne(e){return typeof e=="object"&&e!==null&&typeof e[Symbol.asyncDispose]=="function"}var _=class{constructor(o){this._handler=this._defaultHandler=typeof o=="function"?o:f}get handler(){return this._handler}set handler(o){this._handler=typeof o=="function"?o:this._defaultHandler}reset(){this._handler=this._defaultHandler}handle(o){this._handler(o)}handleSafe(o){try{this.handle(o)}catch(s){}}};var j=new _,E=class extends i{constructor(s){super();this._disposed=!1;this._action=typeof s=="function"?s:f}get disposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;try{this._action()}catch(s){j.handle(s)}}}},z=class extends a{constructor(s){super();this._disposed=!1;this._action=typeof s=="function"?s:b}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){if(!this._disposed){this._disposed=!0;try{yield this._action()}catch(s){j.handle(s)}}})}};function Ze(e,o){let s;try{s=o(e)}catch(t){return x(e,()=>{throw t})}return s instanceof Promise?s.then(t=>x(e,()=>t)).catch(t=>x(e,()=>{throw t})):x(e,()=>s)}function x(e,o){let s=e.dispose();return s instanceof Promise?s.then(o):o()}export{u as AbortDisposable,m as AsyncDisposableAction,a as AsyncDisposiq,a as BaseAsyncDisposable,i as BaseDisposable,S as BoolDisposable,S as BooleanDisposable,c as CompositeDisposable,R as Disposable,r as DisposableAction,g as DisposableContainer,c as DisposableStore,i as Disposiq,P as ObjectDisposedException,E as SafeActionDisposable,z as SafeAsyncActionDisposable,g as SerialDisposable,B as createDisposable,N as createDisposableCompat,U as createDisposiq,F as disposableFromEvent,W as disposableFromEventOnce,w as disposeAll,w as disposeAllSafe,I as disposeAllUnsafe,p as emptyDisposable,Oe as isAsyncDisposableCompat,He as isDisposable,We as isDisposableCompat,Fe as isDisposableLike,Ne as isSystemAsyncDisposable,Be as isSystemDisposable,F as on,W as once,j as safeDisposableExceptionHandlerManager,B as toDisposable,N as toDisposableCompat,U as toDisposiq,Ze as using};
//# sourceMappingURL=index.js.map