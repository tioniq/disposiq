"use strict";var I=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var G=Object.prototype.hasOwnProperty;var J=(s,o)=>{for(var e in o)I(s,e,{get:o[e],enumerable:!0})},V=(s,o,e,t)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of Q(o))!G.call(s,i)&&i!==e&&I(s,i,{get:()=>o[i],enumerable:!(t=M(o,i))||t.enumerable});return s};var X=s=>V(I({},"__esModule",{value:!0}),s);var l=(s,o,e)=>new Promise((t,i)=>{var y=d=>{try{S(e.next(d))}catch(T){i(T)}},U=d=>{try{S(e.throw(d))}catch(T){i(T)}},S=d=>d.done?t(d.value):Promise.resolve(d.value).then(y,U);S((e=e.apply(s,o)).next())});var te={};J(te,{AbortDisposable:()=>u,AsyncDisposableAction:()=>m,AsyncDisposiq:()=>a,BaseAsyncDisposable:()=>a,BaseDisposable:()=>r,BoolDisposable:()=>w,BooleanDisposable:()=>w,CompositeDisposable:()=>c,Disposable:()=>E,DisposableAction:()=>n,DisposableContainer:()=>A,DisposableStore:()=>c,Disposiq:()=>r,ObjectDisposedException:()=>b,SafeActionDisposable:()=>z,SafeAsyncActionDisposable:()=>j,SerialDisposable:()=>A,createDisposable:()=>O,createDisposableCompat:()=>B,createDisposiq:()=>N,disposableFromEvent:()=>H,disposableFromEventOnce:()=>F,disposeAll:()=>x,disposeAllSafe:()=>x,disposeAllUnsafe:()=>R,emptyDisposable:()=>p,isAsyncDisposableCompat:()=>k,isDisposable:()=>Z,isDisposableCompat:()=>L,isDisposableLike:()=>$,isSystemAsyncDisposable:()=>se,isSystemDisposable:()=>ee,on:()=>H,once:()=>F,safeDisposableExceptionHandlerManager:()=>K,toDisposable:()=>O,toDisposableCompat:()=>B,toDisposiq:()=>N,using:()=>oe});module.exports=X(te);"dispose"in Symbol||(Symbol.dispose=Symbol("Symbol.dispose"));"asyncDispose"in Symbol||(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));var r=class{[Symbol.dispose](){this.dispose()}},a=class extends r{[Symbol.asyncDispose](){return this.dispose()}};var u=class extends r{constructor(o){super(),this._controller=o}get disposed(){return this._controller.signal.aborted}get signal(){return this._controller.signal}dispose(){this._controller.abort()}};var f=Object.freeze(()=>{}),h=Object.freeze(()=>Promise.resolve());var n=class extends r{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:f}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._action())}},m=class extends a{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:h}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){this._disposed||(this._disposed=!0,yield this._action())})}};var q=class{constructor(o){this.value=o,this.next=null}},D=class{constructor(){this.head=null,this.tail=null,this.length=0}enqueue(o){let e=new q(o);this.head?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),this.length++}dequeue(){let o=this.head;return o===null?null:(this.head=o.next,this.length--,o.value)}isEmpty(){return this.length===0}getHead(){var o,e;return(e=(o=this.head)==null?void 0:o.value)!=null?e:null}getLength(){return this.length}forEach(o){let e=this.head;for(;e!==null;)o(e.value),e=e.next}toArray(){let o=[],e=this.head;for(;e!==null;)o.push(e.value),e=e.next;return o}clear(){this.head=null,this.tail=null,this.length=0}};var _=class{constructor(o){this._scrap=new D,this._size=o}get size(){return this._size}set size(o){this._size=o}get all(){return this._scrap.toArray()}get full(){return this._scrap.length===this._size}lift(){return this._scrap.length>0?this._scrap.dequeue():null}throw(o){if(this._scrap.length<this._size)return this._scrap.enqueue(o),null;if(this._size===0)return o;let e=this._scrap.dequeue();return this._scrap.enqueue(o),e}clear(){this._scrap.clear()}};var v=new _(10);function x(s){let o=s.length;if(o===0)return;let e=v.lift();e===null?e=new Array(o):e.length<o&&(e.length=o);for(let t=0;t<o;t++)e[t]=s[t];s.length=0;for(let t=0;t<o;++t){let i=e[t];i&&(typeof i=="function"?i():i.dispose())}e.fill(void 0,0,o),v.full&&(v.size*=2),v.throw(e)}function R(s){for(let o=0;o<s.length;++o){let e=s[o];e&&(typeof e=="function"?e():e.dispose())}s.length=0}var b=class extends Error{constructor(o){super(o||"Object disposed")}};var c=class s extends r{constructor(){super();this._disposed=!1;this._disposables=new Array}get disposed(){return this._disposed}add(...e){this.addAll(e)}addAll(e){if(!(!e||e.length===0)){if(this._disposed){for(let t of e)t&&(typeof t=="function"?t():t.dispose());return}for(let t=0;t<e.length;t++){let i=e[t];i&&this._disposables.push(typeof i=="function"?new n(i):i)}}}addOne(e){if(e){if(this._disposed){typeof e=="function"?e():e.dispose();return}typeof e=="function"&&(e=new n(e)),this._disposables.push(e)}}remove(e){let t=this._disposables.indexOf(e);return t===-1?!1:(this._disposables.splice(t,1),!0)}addTimeout(e,t){if(typeof e=="function"){let i=setTimeout(e,t);this.add(()=>clearTimeout(i));return}this.add(()=>clearTimeout(e))}addInterval(e,t){if(typeof e=="function"){let i=setInterval(e,t);this.add(()=>clearInterval(i));return}this.add(()=>clearInterval(e))}throwIfDisposed(e){if(this._disposed)throw new b(e)}dispose(){this._disposed||(this._disposed=!0,R(this._disposables))}disposeCurrent(){x(this._disposables)}static from(e,t){if(typeof t=="function"){let y=new s;return y.addAll(e.map(t)),y}let i=new s;return i.addAll(e),i}};var A=class extends r{constructor(e=void 0){super();this._disposed=!1;this._disposable=e}get disposed(){return this._disposed}get disposable(){return this._disposable}set(e){if(this._disposed){e.dispose();return}let t=this._disposable;this._disposable=e,t!=null&&t.dispose()}replace(e){if(this._disposed){e.dispose();return}this._disposable=e}disposeCurrent(){let e=this._disposable;e!=null&&(this._disposable=void 0,e.dispose())}dispose(){this._disposed||(this._disposed=!0,this._disposable!=null&&(this._disposable.dispose(),this._disposable=void 0))}};var w=class extends r{constructor(e=!1){super();this._disposed=!1;this._disposed=e}get disposed(){return this._disposed}dispose(){this._disposed=!0}};function H(s,o,e){return s.on(o,e),new n(()=>{s.off(o,e)})}function F(s,o,e){return s.once(o,e),new n(()=>{s.off(o,e)})}var W=Promise.resolve(),P=class extends a{dispose(){return W}[Symbol.dispose](){}[Symbol.asyncDispose](){return W}},Y=new P,p=Object.freeze(Y);function O(s){return s?typeof s=="function"?new n(s):typeof s!="object"?p:"dispose"in s?s:Symbol.dispose in s?new n(()=>{s[Symbol.dispose]()}):Symbol.asyncDispose in s?new m(()=>l(this,null,function*(){yield s[Symbol.asyncDispose]()})):"unref"in s?new n(()=>s.unref()):s instanceof AbortController?new u(s):p:p}function B(s){if(!s)return p;if(typeof s=="function")return new n(s);if(typeof s!="object")return p;let o="dispose"in s,e=Symbol.dispose in s;return o&&e?s:o?new n(()=>s.dispose()):e?new n(()=>s[Symbol.dispose]()):Symbol.asyncDispose in s?new n(()=>l(this,null,function*(){s[Symbol.asyncDispose]()})):"unref"in s?new n(()=>s.unref()):s instanceof AbortController?new u(s):p}function N(s){if(!s)return p;if(s instanceof r)return s;if(typeof s=="function")return new n(s);if(typeof s!="object")return p;let o="dispose"in s&&typeof s.dispose=="function",e=Symbol.dispose in s;return o&&e?new class extends r{dispose(){s.dispose()}[Symbol.dispose](){s[Symbol.dispose]()}}:o?new n(()=>s.dispose()):e?new n(()=>s[Symbol.dispose]()):Symbol.asyncDispose in s?new m(()=>l(this,null,function*(){yield s[Symbol.asyncDispose]()})):"unref"in s?new n(()=>s.unref()):s instanceof AbortController?new u(s):p}var E=class extends r{constructor(){super(...arguments);this._store=new c}get disposed(){return this._store.disposed}register(e){return this._store.addOne(e),e}throwIfDisposed(e){this._store.throwIfDisposed(e)}addDisposable(e){this._store.addOne(e)}addDisposables(...e){this._store.addAll(e)}dispose(){this._store.dispose()}};r.prototype.disposeWith=function(s){return s.add(this)};function Z(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"}function $(s){return typeof s=="function"||typeof s=="object"&&s!==null&&typeof s.dispose=="function"}function L(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&typeof s[Symbol.dispose]=="function"}function k(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&typeof s[Symbol.asyncDispose]=="function"}function ee(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.dispose]=="function"}function se(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.asyncDispose]=="function"}var C=class{constructor(o){this._handler=this._defaultHandler=typeof o=="function"?o:f}get handler(){return this._handler}set handler(o){this._handler=typeof o=="function"?o:this._defaultHandler}reset(){this._handler=this._defaultHandler}handle(o){this._handler(o)}handleSafe(o){try{this.handle(o)}catch(e){}}};var K=new C,z=class extends r{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:f}get disposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;try{this._action()}catch(e){K.handle(e)}}}},j=class extends a{constructor(e){super();this._disposed=!1;this._action=typeof e=="function"?e:h}get disposed(){return this._disposed}dispose(){return l(this,null,function*(){if(!this._disposed){this._disposed=!0;try{yield this._action()}catch(e){K.handle(e)}}})}};function oe(s,o){let e;try{e=o(s)}catch(t){return g(s,()=>{throw t})}return e instanceof Promise?e.then(t=>g(s,()=>t)).catch(t=>g(s,()=>{throw t})):g(s,()=>e)}function g(s,o){let e=s.dispose();return e instanceof Promise?e.then(o):o()}0&&(module.exports={AbortDisposable,AsyncDisposableAction,AsyncDisposiq,BaseAsyncDisposable,BaseDisposable,BoolDisposable,BooleanDisposable,CompositeDisposable,Disposable,DisposableAction,DisposableContainer,DisposableStore,Disposiq,ObjectDisposedException,SafeActionDisposable,SafeAsyncActionDisposable,SerialDisposable,createDisposable,createDisposableCompat,createDisposiq,disposableFromEvent,disposableFromEventOnce,disposeAll,disposeAllSafe,disposeAllUnsafe,emptyDisposable,isAsyncDisposableCompat,isDisposable,isDisposableCompat,isDisposableLike,isSystemAsyncDisposable,isSystemDisposable,on,once,safeDisposableExceptionHandlerManager,toDisposable,toDisposableCompat,toDisposiq,using});
//# sourceMappingURL=index.cjs.map